# 编译资产（Mix）

## 简介

[Laravel Mix](https://github.com/JeffreyWay/laravel-mix) 提供了一个流畅的 API，用于使用几种常见的 CSS 和 JavaScript 预处理器为你的 Laravel 应用程序定义 Webpack 构建步骤。通过简单的方法链式调用，你可以流畅地定义资产管道。例如：

```js
mix.js('resources/js/app.js', 'public/js')
   .sass('resources/sass/app.scss', 'public/css');
```

如果你对开始使用 Webpack 和资产编译感到困惑和不知所措，那么你一定会喜欢 Laravel Mix。但是，在开发应用程序时不需要使用它；你可以自由使用任何你想要的资产管道工具，甚至根本不使用任何资产管道工具。

## 安装 & 设置

### 安装 Node

在触发 Mix 之前，必须首先确保计算机上已安装 Node.js 和 NPM。

```bash
node -v
npm -v
```

默认情况下，Laravel Homestead 包含你需要的一切；但是，如果你不使用 Vagrant，那么你可以从下载页面使用简单的图形安装器轻松安装 Node 和 NPM 的最新版本。

### Laravel Mix

唯一剩下的步骤是安装 Laravel Mix。在 Laravel 的全新安装中，你将在目录结构的根目录中找到 `package.json` 文件。默认的 `package.json` 文件包含起步所需的一切。可以把它想象成你的 `composer.json` 文件，除了它定义了 Node 依赖而不是 PHP。你可以通过运行来安装它引用的依赖项：

```bash
npm install
```

## 运行 Mix

Mix 是 [Webpack](https://webpack.js.org/) 之上的配置层，因此要运行 Mix 任务，你只需执行默认的 Laravel `package.json` 文件中包含的一个 NPM 脚本：

```bash
// Run all Mix tasks...
npm run dev

// Run all Mix tasks and minify output...
npm run production
```

### 监视资产的变化

`npm run watch` 命令将继续在终端中运行，并监视所有相关文件的更改。然后，Webpack 会在检测到更改时自动重新编译你的资产：

```bash
npm run watch
```

你可能会发现，在某些环境中，当你的文件更改时，Webpack 并不更新。如果你的系统是这种情况，请考虑使用 `watch-poll` 命令：

```bash
npm run watch-poll
```

## 使用样式表

`webpack.mix.js` 文件是所有资产编译的入口点。可以把它想象成 Webpack 的轻量级配置包装器。可以将混合任务链接在一起，以准确定义应该如何编译资产。

### Less

`less` 方法可以用来将编译 [less](http://lesscss.org/) 成 CSS。让我们编译主要的 `app.less` 文件为 `public/css/app.css`。

```js
mix.less('resources/less/app.less', 'public/css');
```

对 `less` 方法的多次调用可用于编译多个文件：

```js
mix.less('resources/less/app.less', 'public/css')
   .less('resources/less/admin.less', 'public/css');
```

如果希望自定义编译后的 CSS 的文件名，你可以将完整的文件路径作为第二个参数传递给 `less` 方法：

```js
mix.less('resources/less/app.less', 'public/stylesheets/styles.css');
```

如果你需要覆盖 [底层的 Less 插件选项](https://github.com/webpack-contrib/less-loader#options)，你可以传递一个对象到 `mix.less()` 作为其第三个参数：

```js
mix.less('resources/less/app.less', 'public/css', {
    strictMath: true
});
```

### Sass

## 使用 JavaScript

## 复制文件 & 目录

## 版本控制 / 缓存销毁

## Browsersync 重载

## 环境变量

## 通知
